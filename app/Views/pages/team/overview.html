<!-- app/Views/pages/team/overview.html -->
{% extends "layouts/base.html" %}

{% block title %}{{ team_info.name }} - Kader√ºbersicht - {{ app_name }}{% endblock %}

{% block content %}
<div class="team-overview">
    <!-- Header mit Team-Informationen -->
    <header class="team-header">
        <div class="team-info-card">
            <div class="team-logo">
                {% if team_info.logo_url %}
                <img src="{{ team_info.logo_url }}" alt="{{ team_info.name }} Logo" class="logo">
                {% else %}
                <div class="logo-placeholder">{{ team_info.name|first }}</div>
                {% endif %}
            </div>

            <div class="team-details">
                <h1>{{ team_info.name }}</h1>
                <div class="team-meta">
                    <span class="league">{{ team_info.league }}</span>
                    <span class="season">{{ team_info.season }}</span>
                    <span class="formation">Formation: {{ team_info.formation }}</span>
                </div>

                <div class="team-stats">
                    <div class="stat">
                        <span class="label">Manager:</span>
                        <span class="value">{{ team_info.manager }}</span>
                    </div>
                    <div class="stat">
                        <span class="label">Stadion:</span>
                        <span class="value">{{ team_info.stadium }}</span>
                    </div>
                    <div class="stat">
                        <span class="label">Kadergr√∂√üe:</span>
                        <span class="value">{{ team_info.squad_size }} Spieler</span>
                    </div>
                    <div class="stat">
                        <span class="label">Durchschnittsalter:</span>
                        <span class="value">{{ team_info.average_age }} Jahre</span>
                    </div>
                </div>
            </div>

            <div class="financial-overview">
                <h3>üí∞ Finanz√ºbersicht</h3>
                <div class="financial-stats">
                    <div class="financial-stat">
                        <span class="label">Gesamtmarktwert:</span>
                        <span class="value highlight">{{ financial_overview.total_market_value_millions }}M ‚Ç¨</span>
                    </div>
                    <div class="financial-stat">
                        <span class="label">Durchschnittswert:</span>
                        <span class="value">{{ financial_overview.avg_market_value|number_format }}‚Ç¨</span>
                    </div>
                    <div class="financial-stat">
                        <span class="label">Wertvollster Spieler:</span>
                        <span class="value">{{ financial_overview.most_valuable_player.name }}</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Kader-Statistiken -->
    <section class="squad-statistics">
        <h2>üìä Kader-Statistiken</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.total_players }}</span>
                    <span class="stat-label">Gesamt</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ü•Ö</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.goalkeepers }}</span>
                    <span class="stat-label">Torh√ºter</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üõ°Ô∏è</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.defenders }}</span>
                    <span class="stat-label">Verteidiger</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">‚öΩ</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.midfielders }}</span>
                    <span class="stat-label">Mittelfeld</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.forwards }}</span>
                    <span class="stat-label">St√ºrmer</span>
                </div>
            </div>

            <div class="stat-card warning">
                <div class="stat-icon">üè•</div>
                <div class="stat-info">
                    <span class="stat-number">{{ squad_stats.injured_players }}</span>
                    <span class="stat-label">Verletzt</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Filter-Sektion -->
    <section class="player-filters">
        <h2>üîç Spieler filtern</h2>
        <div class="filter-controls">
            <div class="filter-group">
                <label for="position-filter">Position:</label>
                <select id="position-filter" name="position">
                    {% for filter_options.positions as value: label %}
                    <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="status-filter">Status:</label>
                <select id="status-filter" name="status">
                    {% for filter_options.status as value: label %}
                    <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="age-filter">Altersgruppe:</label>
                <select id="age-filter" name="age_group">
                    {% for filter_options.age_groups as value: label %}
                    <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="button" class="filter-reset">Filter zur√ºcksetzen</button>
        </div>
    </section>

    <!-- Debug-Sektion -->
    <section class="debug-section" style="background: #f0f0f0; padding: 20px; margin: 20px 0; border-radius: 8px;">
        <h3>üîç Debug Informationen</h3>
        <p><strong>players_by_position Type:</strong> {{ players_by_position|type }}</p>
        <p><strong>Torh√ºter Array:</strong> {{ players_by_position.goalkeepers|debug }}</p>
        <p><strong>Erstes Element:</strong> {{ players_by_position.goalkeepers.0.name }}</p>
        <div style="background: white; padding: 10px; margin: 10px 0; border-radius: 4px;">
            <pre>{{ players_by_position|json_encode }}</pre>
        </div>
    </section>

    <!-- Spieler nach Positionen -->
    <section class="squad-by-position">
        <h2>üë®‚Äçüíº Kader nach Positionen</h2>

        <!-- Torh√ºter - TEST verschiedene Syntaxe -->
        <div class="position-section" data-position="goalkeepers">
            <h3 class="position-title">
                <span class="position-icon">ü•Ö</span>
                Torh√ºter ({{ players_by_position.goalkeepers|length }})
            </h3>

            <!-- Test 1: Direkter Zugriff auf erstes Element -->
            <div class="test-section">
                <h4>Test 1 - Direkter Zugriff:</h4>
                {% if players_by_position.goalkeepers.0 %}
                <p>Erster Torh√ºter: {{ players_by_position.goalkeepers.0.name }}</p>
                {% endif %}
            </div>

            <!-- Test 2: For-Loop mit Array-Syntax -->
            <div class="test-section">
                <h4>Test 2 - For-Loop (Array-Syntax):</h4>
                {% for players_by_position.goalkeepers as goalkeeper %}
                <div class="simple-player-card" style="border: 1px solid #ccc; padding: 10px; margin: 5px 0; border-radius: 4px;">
                    <strong>Name:</strong> {{ goalkeeper.name }}<br>
                    <strong>Alter:</strong> {{ goalkeeper.age }}<br>
                    <strong>Nummer:</strong> {{ goalkeeper.shirt_number }}
                </div>
                {% endfor %}
            </div>

            <!-- Test 3: Alternative For-Loop Syntax -->
            <div class="test-section">
                <h4>Test 3 - Alternative Syntax:</h4>
                {% if players_by_position.goalkeepers %}
                {% for goalkeeper in players_by_position.goalkeepers %}
                <div class="simple-player-card" style="border: 1px solid #009688; padding: 10px; margin: 5px 0; border-radius: 4px;">
                    <strong>Name:</strong> {{ goalkeeper.name }}<br>
                    <strong>Position:</strong> Torh√ºter<br>
                    <strong>Tore:</strong> {{ goalkeeper.goals }}
                </div>
                {% endfor %}
                {% else %}
                <p>Keine Torh√ºter gefunden</p>
                {% endif %}
            </div>
        </div>

        <!-- Verteidiger -->
        <div class="position-section" data-position="defenders">
            <h3 class="position-title">
                <span class="position-icon">üõ°Ô∏è</span>
                Verteidiger ({{ players_by_position.defenders|length }})
            </h3>

            {% if players_by_position.defenders %}
            <div class="players-grid">
                {% for players_by_position.defenders as player %}
                <div class="player-card">
                    <div class="player-header">
                        <div class="player-avatar">
                            <div class="player-initials">{{ player.name|first }}{{ player.name|last }}</div>
                            <div class="shirt-number">{{ player.shirt_number }}</div>
                        </div>
                        <div class="player-basic-info">
                            <h4 class="player-name">{{ player.name }}</h4>
                            <div class="player-meta">
                                <span class="player-age">{{ player.age }} Jahre</span>
                                <span class="player-nationality">{{ player.nationality }}</span>
                            </div>
                        </div>
                        {% if player.injured %}
                        <div class="injury-status">
                            <span class="injury-icon">üè•</span>
                            <span class="injury-text">Verletzt</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="player-stats">
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="stat-icon">‚öΩ</span>
                                <span class="stat-value">{{ player.goals }}</span>
                                <span class="stat-label">Tore</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üéØ</span>
                                <span class="stat-value">{{ player.assists }}</span>
                                <span class="stat-label">Assists</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üìä</span>
                                <span class="stat-value">{{ player.rating }}</span>
                                <span class="stat-label">Rating</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üëï</span>
                                <span class="stat-value">{{ player.appearances }}</span>
                                <span class="stat-label">Spiele</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-players">Keine Verteidiger im Kader</p>
            {% endif %}
        </div>

        <!-- Mittelfeldspieler -->
        <div class="position-section" data-position="midfielders">
            <h3 class="position-title">
                <span class="position-icon">‚öΩ</span>
                Mittelfeldspieler ({{ players_by_position.midfielders|length }})
            </h3>

            {% if players_by_position.midfielders %}
            <div class="players-grid">
                {% for players_by_position.midfielders as player %}
                <div class="player-card">
                    <div class="player-header">
                        <div class="player-avatar">
                            <div class="player-initials">{{ player.name|first }}{{ player.name|last }}</div>
                            <div class="shirt-number">{{ player.shirt_number }}</div>
                        </div>
                        <div class="player-basic-info">
                            <h4 class="player-name">{{ player.name }}</h4>
                            <div class="player-meta">
                                <span class="player-age">{{ player.age }} Jahre</span>
                                <span class="player-nationality">{{ player.nationality }}</span>
                            </div>
                        </div>
                        {% if player.injured %}
                        <div class="injury-status">
                            <span class="injury-icon">üè•</span>
                            <span class="injury-text">Verletzt</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="player-stats">
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="stat-icon">‚öΩ</span>
                                <span class="stat-value">{{ player.goals }}</span>
                                <span class="stat-label">Tore</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üéØ</span>
                                <span class="stat-value">{{ player.assists }}</span>
                                <span class="stat-label">Assists</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üìä</span>
                                <span class="stat-value">{{ player.rating }}</span>
                                <span class="stat-label">Rating</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üëï</span>
                                <span class="stat-value">{{ player.appearances }}</span>
                                <span class="stat-label">Spiele</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-players">Keine Mittelfeldspieler im Kader</p>
            {% endif %}
        </div>

        <!-- St√ºrmer -->
        <div class="position-section" data-position="forwards">
            <h3 class="position-title">
                <span class="position-icon">üéØ</span>
                St√ºrmer ({{ players_by_position.forwards|length }})
            </h3>

            {% if players_by_position.forwards %}
            <div class="players-grid">
                {% for players_by_position.forwards as player %}
                <div class="player-card">
                    <div class="player-header">
                        <div class="player-avatar">
                            <div class="player-initials">{{ player.name|first }}{{ player.name|last }}</div>
                            <div class="shirt-number">{{ player.shirt_number }}</div>
                        </div>
                        <div class="player-basic-info">
                            <h4 class="player-name">{{ player.name }}</h4>
                            <div class="player-meta">
                                <span class="player-age">{{ player.age }} Jahre</span>
                                <span class="player-nationality">{{ player.nationality }}</span>
                            </div>
                        </div>
                        {% if player.injured %}
                        <div class="injury-status">
                            <span class="injury-icon">üè•</span>
                            <span class="injury-text">Verletzt</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="player-stats">
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="stat-icon">‚öΩ</span>
                                <span class="stat-value">{{ player.goals }}</span>
                                <span class="stat-label">Tore</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üéØ</span>
                                <span class="stat-value">{{ player.assists }}</span>
                                <span class="stat-label">Assists</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üìä</span>
                                <span class="stat-value">{{ player.rating }}</span>
                                <span class="stat-label">Rating</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">üëï</span>
                                <span class="stat-value">{{ player.appearances }}</span>
                                <span class="stat-label">Spiele</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-players">Keine St√ºrmer im Kader</p>
            {% endif %}
        </div>
    </section>

    <!-- Verletzte Spieler √úbersicht -->
    {% if squad_stats.injured_players > 0 %}
    <section class="injured-players">
        <h2 class="section-title warning">üè• Verletzte Spieler</h2>
        <div class="injured-list">
            {% for players_by_position as position: players %}
            {% for players as player %}
            {% if player.injured %}
            <div class="injured-player-item">
                <div class="player-info">
                    <span class="player-name">{{ player.name }}</span>
                    <span class="player-position">({{ position|translate_position }})</span>
                </div>
                {% if player.injury_until %}
                <div class="injury-info">
                    <span class="injury-until">Bis: {{ player.injury_until|date }}</span>
                </div>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Quick Actions -->
    <section class="team-actions">
        <h2>‚ö° Schnellaktionen</h2>
        <div class="action-buttons">
            <a href="/team/tactics" class="action-btn primary">
                <span class="btn-icon">üìã</span>
                Taktik bearbeiten
            </a>
            <a href="/transfers" class="action-btn secondary">
                <span class="btn-icon">üîÑ</span>
                Transfermarkt
            </a>
            <a href="/team/training" class="action-btn secondary">
                <span class="btn-icon">üèÉ‚Äç‚ôÇÔ∏è</span>
                Training planen
            </a>
            <a href="/team/contracts" class="action-btn secondary">
                <span class="btn-icon">üìÑ</span>
                Vertr√§ge verwalten
            </a>
        </div>
    </section>
</div>

<style>
    .team-overview {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .team-header {
        margin-bottom: 40px;
    }

    .team-info-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 30px;
        align-items: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .team-logo .logo {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
    }

    .logo-placeholder {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: rgba(255,255,255,0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        font-weight: bold;
    }

    .team-details h1 {
        margin: 0 0 10px 0;
        font-size: 2.5rem;
        font-weight: 700;
    }

    .team-meta {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .team-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }

    .stat {
        display: flex;
        justify-content: space-between;
    }

    .stat .label {
        opacity: 0.8;
    }

    .stat .value {
        font-weight: 600;
    }

    .financial-overview h3 {
        margin: 0 0 15px 0;
        font-size: 1.2rem;
    }

    .financial-stats {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .financial-stat {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .financial-stat .value.highlight {
        font-size: 1.1rem;
        font-weight: 700;
        color: #ffd700;
    }

    .squad-statistics {
        margin-bottom: 40px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .stat-card {
        background: white;
        padding: 25px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: transform 0.2s;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .stat-card.warning {
        background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        color: white;
    }

    .stat-icon {
        font-size: 2rem;
    }

    .stat-number {
        display: block;
        font-size: 2rem;
        font-weight: 700;
        line-height: 1;
    }

    .stat-label {
        display: block;
        font-size: 0.9rem;
        opacity: 0.8;
    }

    .player-filters {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 40px;
    }

    .filter-controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        align-items: end;
        margin-top: 20px;
    }

    .filter-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #555;
    }

    .filter-group select {
        width: 100%;
        padding: 10px 15px;
        border: 2px solid #e1e5e9;
        border-radius: 8px;
        background: white;
        font-size: 0.9rem;
    }

    .filter-reset {
        padding: 10px 20px;
        background: #6c757d;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: background 0.2s;
    }

    .filter-reset:hover {
        background: #5a6268;
    }

    .position-section {
        margin-bottom: 50px;
    }

    .position-title {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        font-size: 1.5rem;
        font-weight: 600;
        color: #333;
    }

    .position-icon {
        font-size: 1.8rem;
    }

    .players-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 20px;
    }

    .no-players {
        text-align: center;
        padding: 40px;
        color: #6c757d;
        font-style: italic;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .injured-players {
        background: #fff5f5;
        border: 2px solid #fed7d7;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 40px;
    }

    .section-title.warning {
        color: #e53e3e;
        margin-bottom: 20px;
    }

    .injured-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
    }

    .injured-player-item {
        background: white;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #e53e3e;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .player-info {
        display: flex;
        gap: 10px;
        align-items: center;
    }

    .player-name {
        font-weight: 600;
        color: #333;
    }

    .player-position {
        color: #6c757d;
        font-size: 0.9rem;
    }

    .injury-info {
        text-align: right;
    }

    .injury-until {
        color: #e53e3e;
        font-size: 0.9rem;
        font-weight: 500;
    }

    .team-actions {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        padding: 30px;
        border-radius: 15px;
        color: white;
    }

    .team-actions h2 {
        margin-bottom: 25px;
        color: white;
    }

    .action-buttons {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }

    .action-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 15px 20px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.2s;
        text-align: center;
        justify-content: center;
    }

    .action-btn.primary {
        background: white;
        color: #f5576c;
    }

    .action-btn.secondary {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 2px solid rgba(255,255,255,0.3);
    }

    .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .action-btn.primary:hover {
        background: #f8f9fa;
    }

    .action-btn.secondary:hover {
        background: rgba(255,255,255,0.3);
    }

    .btn-icon {
        font-size: 1.2rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .team-info-card {
            grid-template-columns: 1fr;
            text-align: center;
            gap: 20px;
        }

        .team-stats {
            grid-template-columns: 1fr;
        }

        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .filter-controls {
            grid-template-columns: 1fr;
        }

        .players-grid {
            grid-template-columns: 1fr;
        }

        .action-buttons {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 480px) {
        .team-overview {
            padding: 15px;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }

        .team-details h1 {
            font-size: 2rem;
        }

        .team-meta {
            flex-direction: column;
            gap: 10px;
        }
    }
</style>

<script>
    // JavaScript f√ºr Filter-Funktionalit√§t
    document.addEventListener('DOMContentLoaded', function() {
        const positionFilter = document.getElementById('position-filter');
        const statusFilter = document.getElementById('status-filter');
        const ageFilter = document.getElementById('age-filter');
        const resetButton = document.querySelector('.filter-reset');

        // Filter Event Listeners
        positionFilter.addEventListener('change', applyFilters);
        statusFilter.addEventListener('change', applyFilters);
        ageFilter.addEventListener('change', applyFilters);
        resetButton.addEventListener('click', resetFilters);

        function applyFilters() {
            const positionValue = positionFilter.value;
            const statusValue = statusFilter.value;
            const ageValue = ageFilter.value;

            const positionSections = document.querySelectorAll('.position-section');

            positionSections.forEach(section => {
                const position = section.dataset.position;
                let showSection = true;

                // Position Filter
                if (positionValue !== 'all' && position !== positionValue) {
                    showSection = false;
                }

                // Show/Hide Section
                section.style.display = showSection ? 'block' : 'none';

                // Filter individual player cards within visible sections
                if (showSection) {
                    const playerCards = section.querySelectorAll('.player-card');
                    playerCards.forEach(card => {
                        let showCard = true;

                        // Status Filter (injured/available)
                        if (statusValue !== 'all') {
                            const isInjured = card.querySelector('.injury-status') !== null;
                            if (statusValue === 'injured' && !isInjured) showCard = false;
                            if (statusValue === 'available' && isInjured) showCard = false;
                        }

                        // Age Filter
                        if (ageValue !== 'all') {
                            const ageElement = card.querySelector('.player-age');
                            if (ageElement) {
                                const age = parseInt(ageElement.textContent);
                                if (ageValue === 'young' && age >= 21) showCard = false;
                                if (ageValue === 'prime' && (age < 21 || age > 30)) showCard = false;
                                if (ageValue === 'veteran' && age <= 30) showCard = false;
                            }
                        }

                        card.style.display = showCard ? 'block' : 'none';
                    });
                }
            });

            // Update statistics after filtering
            updateFilteredStats();
        }

        function resetFilters() {
            positionFilter.value = 'all';
            statusFilter.value = 'all';
            ageFilter.value = 'all';

            // Show all sections and cards
            document.querySelectorAll('.position-section').forEach(section => {
                section.style.display = 'block';
            });

            document.querySelectorAll('.player-card').forEach(card => {
                card.style.display = 'block';
            });

            updateFilteredStats();
        }

        function updateFilteredStats() {
            const visibleCards = document.querySelectorAll('.player-card[style="display: block"], .player-card:not([style*="display: none"])');
            const visibleCount = visibleCards.length;

            // Update player count display if needed
            const countElement = document.querySelector('.filtered-count');
            if (countElement) {
                countElement.textContent = `${visibleCount} Spieler gefunden`;
            }
        }

        // Add smooth scrolling for position navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    });
</script>
{% endblock %}