<!-- app/Views/pages/home.html -->
{% extends "layouts/base.html" %}

{% block title %}{{ app_name }} - Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header Section -->
    <header class="dashboard-header">
        <h1>{{ welcome_message }}</h1>
        <div class="user-info">
            <span class="user-name">{{ user.name }}</span>
            {% if user.is_admin %}
            <span class="badge badge-admin">Admin</span>
            {% endif %}
            {% if user.is_premium %}
            <span class="badge badge-premium">Premium</span>
            {% endif %}
        </div>
    </header>

    <!-- Quick Stats Grid -->
    <div class="stats-grid">
        <div class="stat-card">
            <h3>League Position</h3>
            <div class="stat-value">{{ user.team.position }}</div>
            <div class="stat-label">{{ user.team.league }}</div>
        </div>

        <div class="stat-card">
            <h3>Points</h3>
            <div class="stat-value">{{ user.team.points }}</div>
            <div class="stat-label">{{ season_stats.current_matchday }}/{{ season_stats.total_matchdays }} games</div>
        </div>

        <div class="stat-card">
            <h3>Goals</h3>
            <div class="stat-value">{{ team_performance.goals_scored }}</div>
            <div class="stat-label">{{ team_performance.goals_conceded }} conceded</div>
        </div>

        <div class="stat-card">
            <h3>Coins</h3>
            <div class="stat-value">{{ user.profile.coins|number_format }}</div>
            <div class="stat-label">{{ user.profile.gems }} gems</div>
        </div>
    </div>

    <!-- Next Match Section -->
    <div class="next-match-section">
        <h2>Next Match</h2>
        {% if season_stats.next_match %}
        <div class="match-card match-{{ season_stats.next_match.importance }}">
            <div class="match-teams">
                <div class="team home">
                    <span class="team-name">{{ user.team.name }}</span>
                </div>
                <div class="match-vs">VS</div>
                <div class="team away">
                    <span class="team-name">{{ season_stats.next_match.opponent }}</span>
                </div>
            </div>

            <div class="match-details">
                <div class="match-date">{{ season_stats.next_match.date }}</div>
                <div class="match-time">{{ season_stats.next_match.time }}</div>
                <div class="match-venue">{{ season_stats.next_match.venue }}</div>
            </div>

            <div class="match-prediction">
                <div class="prediction-bar">
                    <div class="prediction-segment home"
                         style="width: {{ season_stats.next_match.prediction.home_win }}%">
                        {{ season_stats.next_match.prediction.home_win }}%
                    </div>
                    <div class="prediction-segment draw" style="width: {{ season_stats.next_match.prediction.draw }}%">
                        {{ season_stats.next_match.prediction.draw }}%
                    </div>
                    <div class="prediction-segment away"
                         style="width: {{ season_stats.next_match.prediction.away_win }}%">
                        {{ season_stats.next_match.prediction.away_win }}%
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <p>No upcoming matches scheduled.</p>
        {% endif %}
    </div>

    <!-- League Table Section -->
    <div class="league-table-section">
        <h2>League Table (Top 5)</h2>
        <table class="league-table">
            <thead>
            <tr>
                <th>Pos</th>
                <th>Team</th>
                <th>P</th>
                <th>W</th>
                <th>D</th>
                <th>L</th>
                <th>GD</th>
                <th>Pts</th>
            </tr>
            </thead>
            <tbody>
            {% for team in league_table %}
            <tr class="{% if team.team == user.team.name %}current-team{% endif %}">
                <td>{{ team.position }}</td>
                <td>{{ team.team }}</td>
                <td>{{ team.played }}</td>
                <td>{{ team.wins }}</td>
                <td>{{ team.draws }}</td>
                <td>{{ team.losses }}</td>
                <td>{{ team.goal_difference }}</td>
                <td><strong>{{ team.points }}</strong></td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Recent Results -->
    <div class="recent-results-section">
        <h2>Recent Results</h2>
        {% if season_stats.last_results %}
        <div class="results-grid">
            {% for result in season_stats.last_results %}
            <div class="result-card">
                <div class="result-opponent">
                    vs {{ result.opponent }}
                    {% if result.is_home %}
                    <span class="venue-indicator">(H)</span>
                    {% else %}
                    <span class="venue-indicator">(A)</span>
                    {% endif %}
                </div>
                <div class="result-score">{{ result.result }}</div>
                <div class="result-date">{{ result.date }}</div>
                {% if result.scorers %}
                <div class="result-scorers">
                    {% for scorer in result.scorers %}
                    <span class="scorer">{{ scorer }}</span>{% if not loop.last %}, {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No recent results available.</p>
        {% endif %}
    </div>

    <!-- Team Performance -->
    <div class="team-performance-section">
        <h2>Team Performance</h2>
        <div class="performance-grid">
            <div class="performance-card">
                <h3>Top Scorer</h3>
                <div class="player-info">
                    <span class="player-name">Lionel Messi</span>
                    <span class="player-stats">12 goals, 8 assists</span>
                </div>
            </div>

            <div class="performance-card">
                <h3>Best Player</h3>
                <div class="player-info">
                    <span class="player-name">Pedri</span>
                    <span class="player-stats">8.2 rating (18 apps)</span>
                </div>
            </div>

            <div class="performance-card">
                <h3>Injuries</h3>
                <div class="injury-list">
                    <div class="injury-item">
                        <span class="player-name">Ansu Fati</span>
                        <span class="injury-type">Hamstring</span>
                        <span class="return-date">Back: 2025-07-25</span>
                    </div>
                    <div class="injury-item">
                        <span class="player-name">Ousmane Demb√©l√©</span>
                        <span class="injury-type">Ankle</span>
                        <span class="return-date">Back: 2025-07-22</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div class="notifications-section">
        <h2>Notifications</h2>
        <div class="notifications-list">
            <div class="notification priority-high">
                <div class="notification-icon">‚ö†Ô∏è</div>
                <div class="notification-content">
                    <div class="notification-message">Contract of Sergio Busquets expires in 6 months</div>
                    <div class="notification-time">2 hours ago</div>
                </div>
            </div>
            <div class="notification priority-medium">
                <div class="notification-icon">üí∞</div>
                <div class="notification-content">
                    <div class="notification-message">New transfer offer for Pedri: ‚Ç¨80M from Manchester City</div>
                    <div class="notification-time">1 day ago</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Framework Features -->
    <div class="framework-features-section">
        <h2>Framework Features</h2>
        <div class="features-grid">
            <div class="feature-card feature-active">
                <div class="feature-icon">üöÄ</div>
                <div class="feature-content">
                    <h3>High Performance</h3>
                    <p>Optimized routing and caching system</p>
                    <div class="performance-gain">+300% faster than Laravel</div>
                </div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üéØ</div>
                <div class="feature-content">
                    <h3>Attribute Routing</h3>
                    <p>Clean, modern PHP 8.4 attributes</p>
                </div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üé®</div>
                <div class="feature-content">
                    <h3>Custom Template Engine</h3>
                    <p>Twig-like syntax with powerful filters</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}